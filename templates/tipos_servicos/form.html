{% extends "base.html" %}

{% block title %}{{ 'Editar' if tipo else 'Nova' }} Categoria de Despesa - MeetCall System{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-3xl">
    <!-- Cabeçalho -->
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-800">
            {% if tipo %}
            Editar Categoria de Despesa
            {% else %}
            Nova Categoria de Despesa
            {% endif %}
        </h1>
        <p class="text-gray-600 mt-1">Categorias de despesas operacionais do call center</p>
    </div>

    <!-- Formulário -->
    <div class="bg-white rounded-lg shadow-md p-6">
        <form method="POST" id="tipoForm">
            <div class="grid grid-cols-1 gap-6">
                <!-- Nome -->
                <div>
                    <label for="nome" class="block text-sm font-medium text-gray-700 mb-2">
                        Nome da Categoria <span class="text-red-500">*</span>
                    </label>
                    <input type="text" 
                           id="nome" 
                           name="nome" 
                           value="{{ tipo.nome if tipo else '' }}"
                           placeholder="Ex: Telefonia, Recursos Humanos, Tecnologia..."
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-meetcall-purple focus:border-transparent"
                           required>
                    <p class="text-xs text-gray-500 mt-1">
                        Nome da categoria de despesa operacional
                    </p>
                </div>

                <!-- Categoria Pai -->
                <div>
                    <label for="parent_id" class="block text-sm font-medium text-gray-700 mb-2">
                        Grupo (Categoria Pai)
                    </label>
                    <select id="parent_id" 
                            name="parent_id"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-meetcall-purple focus:border-transparent">
                        <option value="">Nenhum (Categoria Principal)</option>
                        {% for categoria in categorias %}
                        <option value="{{ categoria.id }}" 
                                {% if tipo and tipo.parent_id == categoria.id %}selected{% endif %}>
                            {{ categoria.nome }}
                        </option>
                        {% endfor %}
                    </select>
                    <p class="text-xs text-gray-500 mt-1">
                        Selecione um grupo para organizar hierarquicamente (ex: "CRM" dentro de "Tecnologia")
                    </p>
                </div>

                <!-- Descrição -->
                <div>
                    <label for="descricao" class="block text-sm font-medium text-gray-700 mb-2">
                        Descrição
                    </label>
                    <textarea id="descricao" 
                              name="descricao" 
                              rows="3"
                              placeholder="Descreva o tipo de despesa desta categoria..."
                              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-meetcall-purple focus:border-transparent">{{ tipo.descricao if tipo and tipo.descricao and tipo.descricao != 'None' else '' }}</textarea>
                    <p class="text-xs text-gray-500 mt-1">
                        Informações adicionais sobre esta categoria
                    </p>
                </div>
            </div>

            <!-- Botões -->
            <div class="flex justify-end space-x-4 mt-8">
                <a href="{{ url_for('tipos_servicos.lista') }}" 
                   class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">
                    Cancelar
                </a>
                <button type="submit" 
                        class="px-6 py-2 bg-meetcall-purple hover:bg-meetcall-purple-dark text-white rounded-lg transition">
                    <i class="fas fa-save mr-2"></i>
                    {{ 'Atualizar' if tipo else 'Salvar' }}
                </button>
            </div>
        </form>
    </div>

    <!-- Informações Adicionais -->
    <div class="mt-6 bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
        <div class="flex items-start">
            <i class="fas fa-info-circle text-blue-500 mt-1 mr-3"></i>
            <div>
                <h4 class="font-semibold text-blue-900">Sobre Categorias de Despesas</h4>
                <p class="text-sm text-blue-800 mt-1">
                    As categorias organizam as despesas operacionais do call center de forma hierárquica. 
                    Exemplos: <strong>Tecnologia</strong> (categoria principal) pode conter <strong>Software CRM</strong>, 
                    <strong>Infraestrutura TI</strong>, etc. (subcategorias).
                </p>
                <p class="text-sm text-blue-800 mt-2">
                    <strong>Exemplos de categorias principais:</strong> Recursos Humanos, Telefonia, Tecnologia, 
                    Marketing, Administrativo, Infraestrutura.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
